
<script>
var myCenter;

// function initialize(data) {
//   //creates the map with initial properties
//   var mapProp = {
//     center: myCenter,
//     zoom: 15,
//     // create map type
//     mapTypeId:google.maps.MapTypeId.ROADMAP
//   };
//   var map =new google.maps.Map(document.getElementById("map"), mapProp);

//   var marker = [];

//   data.forEach(function(location) {
//     marker = new google.maps.Marker({
//       position: new google.maps.LatLng(location.latitude, location.longitude),
//       map: map
//     });
//   });
//   marker.setMap(map);
// };

// $(function() {
//   var tripId = $('.grab-loc').attr('title');

//   $.get(`/api/locations/${tripId}`)
//     .then(function(data) {
//       myCenter = new google.maps.LatLng(data[0].latitude, data[0].longitude);
//       initialize(data);
//     }, function(err) {
//       console.log(err);
//     });
// });


function initMap(data) {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          center: myCenter,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        var flightPlanCoordinates = [];

        data.forEach(function(location) {
          flightPlanCoordinates.push(new google.maps.LatLng(location.latitude, location.longitude));
        });

        console.log(flightPlanCoordinates);

        var flightPath = new google.maps.Polyline({
          path: flightPlanCoordinates,
          geodesic: true,
          strokeColor: '#FF0000',
          strokeOpacity: 1.0,
          strokeWeight: 2
        });

        var marker = [];

        data.forEach(function(location) {
          marker = new google.maps.Marker({
            position: new google.maps.LatLng(location.latitude, location.longitude),
            map: map
          });
        });

        marker.setMap(map);
        flightPath.setMap(map);
      }

$(function() {
  var tripId = $('.grab-loc').attr('title');

  $.get(`/api/locations/${tripId}`)
    .then(function(data) {
      myCenter = new google.maps.LatLng(data[0].latitude, data[0].longitude);
      initMap(data);
    }, function(err) {
      console.log(err);
    });
});

</script>

